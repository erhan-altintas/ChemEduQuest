<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>ChemEduQuest - Quiz Modus</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f2f5;
            text-align: center;
            padding: 20px;
        }

        .container {
            display: grid;
            grid-template-columns: repeat(18, 1fr);
            gap: 5px;
            max-width: 1200px;
            margin: 20px auto;
        }

        .element {
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            font-weight: bold;
            cursor: pointer;
            user-select: none;
        }

        .element:hover {
            background-color: #eef;
        }

        .element.selected {
            background-color: #b3e5fc;
            border-color: #0288d1;
        }

        .element.disabled {
            background-color: #eee;
            color: #999;
            border-color: #ccc;
            pointer-events: none;
        }

        #submitButton {
            margin-top: 15px;
            padding: 10px 20px;
            font-size: 16px;
            background-color: #0288d1;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        #quizInfo {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            max-width: 1200px;
            margin: 0 auto 20px;
            font-size: 18px;
        }

        #timer, #lives, #score, #highscoreBox {
            background-color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin: 5px;
        }

        #question {
            font-size: 20px;
            margin-bottom: 20px;
            background-color: #fff;
            padding: 15px;
            border-radius: 5px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        #result {
            margin-top: 20px;
            font-size: 18px;
            min-height: 50px;
        }

        .life {
            color: red;
            font-size: 24px;
            margin: 0 3px;
        }

        #startScreen, #endScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: white;
        }

        .screen-content {
            background-color: #333;
            padding: 30px;
            border-radius: 10px;
            max-width: 600px;
            text-align: center;
        }

        .screen-button {
            margin-top: 20px;
            padding: 12px 25px;
            font-size: 18px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #correctAnswer {
            font-weight: bold;
            color: #4CAF50;
        }

        #playgroundButton {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 20px;
            background-color: #673ab7;
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 16px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 1001;
            transition: background-color 0.3s ease;
            text-decoration: none;
        }

        #playgroundButton:hover {
            background-color: #512da8;
        }
    </style>
</head>
<body>
<div id="startScreen">
    <div class="screen-content">
        <h1>Chemische Combinaties Quiz</h1>
        <p>Test je kennis van chemische combinaties!</p>
        <p>Je krijgt een stof te zien en moet de juiste elementen selecteren.</p>
        <p>Je hebt 3 levens en 30 seconden per vraag. Hoe meer vragen je correct beantwoordt, hoe hoger je score!</p>
        <p id="highscoreDisplay" style="margin-top: 10px;"></p>
        <button class="screen-button" id="startButton">Start Quiz</button>
    </div>
</div>

<div id="quizArea" style="display: none;">
    <h1>Chemische Combinaties Quiz</h1>

    <div id="quizInfo">
        <div id="timer">Tijd: 30s</div>
        <div id="score">Score: 0</div>
        <div id="highscoreBox">Highscore: 0</div>
        <div id="lives">Levens: <span class="life">â™¥</span><span class="life">â™¥</span><span class="life">â™¥</span></div>
    </div>

    <div id="question">Vraag zal hier verschijnen...</div>

    <div class="container" id="elementGrid"></div>

    <button id="submitButton">Bevestigen</button>

    <div id="result"></div>
</div>

<div id="endScreen" style="display: none;">
    <div class="screen-content">
        <h1>Quiz Voltooid!</h1>
        <p id="finalScore">Je eindscore: 0</p>
        <p id="finalMessage">Goed gedaan!</p>
        <button class="screen-button" id="restartButton">Opnieuw Spelen</button>
    </div>
</div>

<script>
    const elements = [..."H,He,Li,Be,B,C,N,O,F,Ne,Na,Mg,Al,Si,P,S,Cl,Ar,K,Ca,Sc,Ti,V,Cr,Mn,Fe,Co,Ni,Cu,Zn,Ga,Ge,As,Se,Br,Kr,Rb,Sr,Y,Zr,Nb,Mo,Tc,Ru,Rh,Pd,Ag,Cd,In,Sn,Sb,Te,I,Xe,Cs,Ba,Hf,Ta,W,Re,Os,Ir,Pt,Au,Hg,Tl,Pb,Bi,Po,At,Rn".split(",")];

    const combinations = {
        "H,O": {"name": "Water"},
        "C,O": {"name": "Koolstofdioxide"},
        "Na,Cl": {"name": "Keukenzout"},
        "Fe,O": {"name": "IJzeroxide"},
        "Fe,C": {"name": "Staal"},
        "Cu,Zn": {"name": "Messing"},
        "H,N": {"name": "Ammoniak"},
        "C,H": {"name": "Methaan"},
        "H,Cl": {"name": "Waterstofchloride"},
        "Mg,O": {"name": "Magnesiumoxide"},
        "K,Cl": {"name": "Kaliumchloride"},
        "Zn,O": {"name": "Zinkoxide"},
        "Ag,Br": {"name": "Zilverbromide"},
        "Ti,O": {"name": "Titaandioxide"},
        "C,H,O": {"name": "Glucose"},
        "Ca,C,O": {"name": "Calciumcarbonaat"},
        "N,H,O": {"name": "Salpeterzuur"},
        "Na,H,C,O": {"name": "Natriumbicarbonaat"},
        "Ba,O,S": {"name": "Bariumsulfaat"},
        "Al,O": {"name": "Aluminiumoxide"},
        "Si,O": {"name": "Silica"},
        "S,O": {"name": "Zwaveldioxide"},
        "Pb,O": {"name": "Loodoxide"},
        "Hg,Cl": {"name": "Kwikchloride"},
        "Au,Ag": {"name": "Elektrum"},
        "Ni,Cr": {"name": "Nichroom"},
        "Cu,Sn": {"name": "Brons"},
        "W,C": {"name": "Wolfraamcarbide"},
    };

    let selected = [];
    let currentQuestion = {};
    let score = 0;
    let lives = 3;
    let timeLeft = 30;
    let timer;
    let questionsAnswered = 0;
    const totalQuestions = 10;

    const grid = document.getElementById("elementGrid");
    elements.forEach(el => {
        const div = document.createElement("div");
        div.className = "element";
        div.textContent = el;
        div.dataset.symbol = el;
        div.addEventListener("click", () => {
            if (div.classList.contains("disabled")) return;
            const symbol = div.dataset.symbol;
            const i = selected.indexOf(symbol);
            if (i > -1) {
                selected.splice(i, 1);
                div.classList.remove("selected");
            } else {
                selected.push(symbol);
                div.classList.add("selected");
            }
        });
        grid.appendChild(div);
    });

    document.getElementById("startButton").addEventListener("click", () => {
        document.getElementById("startScreen").style.display = "none";
        document.getElementById("quizArea").style.display = "block";
        startQuiz();
    });

    document.getElementById("restartButton").addEventListener("click", () => {
        document.getElementById("endScreen").style.display = "none";
        document.getElementById("quizArea").style.display = "block";
        startQuiz();
    });

    function startQuiz() {
        score = 0;
        lives = 3;
        questionsAnswered = 0;
        updateScore();
        updateLives();
        updateHighscoreBox();
        nextQuestion();
    }

    function nextQuestion() {
        selected = [];
        document.querySelectorAll(".element").forEach(el => {
            el.classList.remove("selected", "disabled");
        });

        const comboKeys = Object.keys(combinations);
        const randomKey = comboKeys[Math.floor(Math.random() * comboKeys.length)];
        currentQuestion = {
            answer: randomKey.split(","),
            name: combinations[randomKey].name
        };

        const aantal = currentQuestion.answer.length;
        document.getElementById("question").textContent = `Welke elementen vormen ${currentQuestion.name}? (Selecteer ${aantal} element${aantal > 1 ? 'en' : ''})`;

        resetTimer();
        startTimer();
    }

    function startTimer() {
        clearInterval(timer);
        timeLeft = 30;
        updateTimer();
        timer = setInterval(() => {
            timeLeft--;
            updateTimer();
            if (timeLeft <= 0) timeUp();
        }, 1000);
    }

    function resetTimer() {
        clearInterval(timer);
        timeLeft = 30;
        updateTimer();
    }

    function updateTimer() {
        const timerDiv = document.getElementById("timer");
        timerDiv.textContent = `Tijd: ${timeLeft}s`;
        timerDiv.style.color = timeLeft <= 10 ? "red" : "black";
    }

    function updateScore() {
        document.getElementById("score").textContent = `Score: ${score}`;
    }

    function updateHighscoreBox() {
        const high = localStorage.getItem("chemQuizHighscore") || "0";
        document.getElementById("highscoreBox").textContent = `Highscore: ${high}`;
    }

    function updateLives() {
        const livesElement = document.getElementById("lives");
        livesElement.innerHTML = "Levens: ";
        for (let i = 0; i < 3; i++) {
            const heart = document.createElement("span");
            heart.className = "life";
            heart.textContent = i < lives ? "â™¥" : "â™¡";
            livesElement.appendChild(heart);
        }
    }

    function timeUp() {
        clearInterval(timer);
        document.getElementById("result").innerHTML = `Tijd is om! Het juiste antwoord was: <span id="correctAnswer">${currentQuestion.answer.join(" + ")}</span>`;
        loseLife();
    }

    document.getElementById("submitButton").addEventListener("click", () => {
        clearInterval(timer);
        checkAnswer();
    });

    function checkAnswer() {
        const userAnswer = [...selected].sort().join(",");
        const correctAnswer = [...currentQuestion.answer].sort().join(",");

        if (userAnswer === correctAnswer) {
            score += timeLeft;
            questionsAnswered++;
            document.getElementById("result").innerHTML = "Correct! ðŸŽ‰";
            updateScore();
        } else {
            document.getElementById("result").innerHTML = `Helaas, fout. Het juiste antwoord was: <span id="correctAnswer">${currentQuestion.answer.join(" + ")}</span>`;
            loseLife();
        }

        if (lives > 0 && questionsAnswered < totalQuestions) {
            setTimeout(nextQuestion, 2000);
        } else {
            endQuiz();
        }
    }

    function loseLife() {
        lives--;
        updateLives();
        if (lives <= 0) endQuiz();
    }

    function endQuiz() {
        clearInterval(timer);
        document.getElementById("quizArea").style.display = "none";
        document.getElementById("endScreen").style.display = "flex";
        document.getElementById("finalScore").textContent = `Je eindscore: ${score}`;

        const maxScore = totalQuestions * 30;
        const percentage = (score / maxScore) * 100;
        let message = "";

        if (percentage >= 80) message = "Uitstekend! Je kent je chemische combinaties heel goed!";
        else if (percentage >= 60) message = "Goed gedaan! Met wat meer oefening word je nog beter!";
        else if (percentage >= 40) message = "Niet slecht, maar je kunt nog wat meer oefenen!";
        else message = "Blijf oefenen, je wordt vanzelf beter!";

        const oldHighscore = parseInt(localStorage.getItem("chemQuizHighscore") || "0");
        if (score > oldHighscore) {
            localStorage.setItem("chemQuizHighscore", score);
            message += "<br><strong>Nieuwe highscore! ðŸŽ‰</strong>";
        } else {
            message += `<br>Highscore: ${oldHighscore}`;
        }

        document.getElementById("finalMessage").innerHTML = message;
        updateHighscoreBox();
    }

    window.addEventListener("load", () => {
        const high = localStorage.getItem("chemQuizHighscore") || "0";
        document.getElementById("highscoreDisplay").textContent = `Huidige highscore: ${high}`;
        updateHighscoreBox();
    });
</script>

<a href="./oefen.html" id="playgroundButton">Playground</a>
</body>
</html>
